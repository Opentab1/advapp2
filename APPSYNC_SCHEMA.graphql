type SensorData {
  venueId: ID!
  timestamp: String!
  decibels: Float
  light: Float
  indoorTemp: Float
  outdoorTemp: Float
  humidity: Float
  currentSong: String
  albumArt: String
  artist: String
  occupancy: OccupancyData
}

type OccupancyData {
  current: Int
  entries: Int
  exits: Int
  capacity: Int
}

type SensorDataConnection {
  items: [SensorData]
  nextToken: String
}

type Location {
  locationId: ID!
  venueId: ID!
  displayName: String
  locationName: String
  address: String
  timezone: String
  deviceId: String
  mqttTopic: String
}

type LocationConnection {
  items: [Location]
  nextToken: String
}

type OccupancyMetrics {
  venueId: ID!
  current: Int
  todayEntries: Int
  todayExits: Int
  peakOccupancy: Int
  peakTime: String
  sevenDayAvg: Float
  fourteenDayAvg: Float
  thirtyDayAvg: Float
}

type VenueConfig {
  venueId: ID!
  locationId: ID!
  displayName: String
  locationName: String
  mqttTopic: String
  iotEndpoint: String
}

type Query {
  getSensorData(venueId: ID!, timestamp: String!): SensorData
    @aws_cognito_user_pools

  listSensorData(
    venueId: ID!
    startTime: String!
    endTime: String!
    limit: Int
    nextToken: String
  ): SensorDataConnection
    @aws_cognito_user_pools

  listVenueLocations(
    venueId: ID!
    limit: Int
    nextToken: String
  ): LocationConnection
    @aws_cognito_user_pools

  getOccupancyMetrics(venueId: ID!): OccupancyMetrics
    @aws_cognito_user_pools

  getVenueConfig(venueId: ID!, locationId: String!): VenueConfig
    @aws_cognito_user_pools

  getUserSettings(userId: ID!): UserSettings
    @aws_cognito_user_pools

  getVenueSettings(venueId: ID!): VenueSettingsData
    @aws_cognito_user_pools
}

# User Settings for cross-device sync
type UserSettings {
  userId: ID!
  theme: String
  soundAlerts: Boolean
  refreshInterval: Int
  temperatureUnit: String
  timezone: String
  notifications: Boolean
  emailNotifications: EmailNotificationSettings
  termsAccepted: Boolean
  termsAcceptedDate: String
}

type EmailNotificationSettings {
  dailySummary: Boolean
  highOccupancyAlerts: Boolean
  temperatureAlerts: Boolean
  weeklyReports: Boolean
  monthlyInsights: Boolean
  sensorOfflineAlerts: Boolean
}

input EmailNotificationSettingsInput {
  dailySummary: Boolean
  highOccupancyAlerts: Boolean
  temperatureAlerts: Boolean
  weeklyReports: Boolean
  monthlyInsights: Boolean
  sensorOfflineAlerts: Boolean
}

input UserSettingsInput {
  userId: ID!
  theme: String
  soundAlerts: Boolean
  refreshInterval: Int
  temperatureUnit: String
  timezone: String
  notifications: Boolean
  emailNotifications: EmailNotificationSettingsInput
  termsAccepted: Boolean
  termsAcceptedDate: String
}

# Venue Settings for cross-device sync
type VenueSettingsData {
  venueId: ID!
  address: VenueAddress
  toastPOS: ToastPOSConfig
  lastUpdated: String
}

type VenueAddress {
  street: String
  city: String
  state: String
  zipCode: String
  country: String
}

type ToastPOSConfig {
  enabled: Boolean
  apiKey: String
  restaurantGuid: String
}

input VenueAddressInput {
  street: String
  city: String
  state: String
  zipCode: String
  country: String
}

input ToastPOSConfigInput {
  enabled: Boolean
  apiKey: String
  restaurantGuid: String
}

input VenueSettingsInput {
  venueId: ID!
  address: VenueAddressInput
  toastPOS: ToastPOSConfigInput
}

type Mutation {
  saveUserSettings(input: UserSettingsInput!): UserSettings
    @aws_cognito_user_pools

  saveVenueSettings(input: VenueSettingsInput!): VenueSettingsData
    @aws_cognito_user_pools
}

type Schema {
  query: Query
  mutation: Mutation
}
